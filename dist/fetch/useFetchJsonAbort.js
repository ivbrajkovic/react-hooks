"use strict";var __assign=this&&this.__assign||function(){return __assign=Object.assign||function(t){for(var e,r=1,a=arguments.length;r<a;r++)for(var n in e=arguments[r],e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},__assign.apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0});var react_1=require("react"),utils_1=require("@ivbrajkovic/utils"),TYPES={SET_LOADING:"SET_LOADING",SET_ERROR:"SET_ERROR",SET_DATA:"SET_DATA"},initialState={data:null,error:"",loading:!1},reducer=function(t,e){var r=e.type,a=e.payload;switch(r){case TYPES.SET_LOADING:return __assign(__assign({},initialState),{loading:!0});case TYPES.SET_ERROR:return __assign(__assign({},initialState),{error:a});case TYPES.SET_DATA:return __assign(__assign({},initialState),{data:a});default:throw new Error("Unhandled action type: "+r)}},useFetchJsonAbort=function(t,e){void 0===e&&(e={});var r=react_1.useRef(),a=react_1.useReducer(reducer,initialState),n=a[0],i=a[1];react_1.useEffect((function(){i({type:TYPES.SET_LOADING});var a=utils_1.fetchJsonAbortCb(t,e,(function(t,e){i(t?{type:TYPES.SET_ERROR,payload:t.message}:{type:TYPES.SET_DATA,payload:e})}));return r.current=a,function(){r.current&&(r.current=void 0)}}),[t,e]);var s=react_1.useCallback((function(){r.current&&r.current()}),[]);return[n,s]};exports.default=useFetchJsonAbort;