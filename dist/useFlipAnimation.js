"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var react_1=require("react"),utils_1=require("@ivbrajkovic/utils"),invertDefault=function(e){var t=e.delta,n=e.elem;n.style.transform="translate("+t.left+"px, "+t.top+"px)",n.style.transition="transform 0s"},playDefault=function(e){var t=e.elem;t.style.transform="",t.style.transition="transform 300ms ease"},invertAndPlayDefault=function(e){var t=e.delta,n=e.elem;e.previous,e.next;n.animate([{transform:"translate("+t.left+"px, "+t.top+"px)"},{transform:"none"}],{delay:0,duration:300,easing:"ease"})},getDelta=function(e,t){return{top:e.top-t.top,left:e.left-t.left,width:e.width/t.width,height:e.height/t.height}},isZero=function(e){return 0===e.left&&0===e.top&&1===e.width&&1===e.height},useFlipAnimation=function(e){var t=e.root,n=e.invert,r=void 0===n?invertDefault:n,i=e.play,a=void 0===i?playDefault:i,u=e.invertAndPlay,o=void 0===u?invertAndPlayDefault:u,l=e.debounceScrolling,s=void 0===l?0:l,f=e.enable,c=void 0!==f&&f,d=react_1.useRef({}),v=react_1.useRef(!0),p=react_1.useState(!0)[1];react_1.useEffect((function(){v.current=!0,d.current={},p((function(e){return!e}))}),[c]),react_1.useEffect((function(){var e;if(c)return s>0&&(e=utils_1.debounce((function(){v.current=!0,p((function(e){return!e}))}),s),window.addEventListener("scroll",e)),function(){return e&&window.removeEventListener("scroll",e)}}),[c]),react_1.useLayoutEffect((function(){if(t.current&&c){for(var e=t.current.children,n=function(t){var n=e[t],i=n.dataset.key||0,u=n.getBoundingClientRect();if(!v.current&&i in d.current){var l=d.current[i],s=getDelta(l,u);isZero(s)||(o?o({delta:s,elem:n,previous:l,next:u}):(r({delta:s,elem:n,previous:l,next:u}),requestAnimationFrame((function(){a({delta:s,elem:n,previous:l,next:u})}))))}d.current[n.dataset.key]=u},i=0;i<e.length;i++)n(i);v.current=!1}}),[t,r,a,o,c])};exports.default=useFlipAnimation;